<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Service Exchange - Buy and Sell Any Service</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --dark: #1e293b;
            --light: #f8fafc;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .hero {
            padding: 120px 0;
            color: white;
            text-align: center;
        }
        
        .hero h1 {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
        }
        
        .hero p {
            font-size: 1.5rem;
            margin-bottom: 3rem;
        }
        
        .feature-card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .btn-primary-custom {
            background: linear-gradient(135deg, var(--primary), #4f46e5);
            border: none;
            padding: 12px 30px;
            font-weight: 600;
            border-radius: 8px;
        }
        
        .service-tag {
            display: inline-block;
            padding: 6px 14px;
            background: var(--light);
            border-radius: 20px;
            margin: 4px;
            font-size: 14px;
        }
        
        .stats {
            background: var(--dark);
            color: white;
            padding: 60px 0;
        }
        
        .modal-content {
            border-radius: 12px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand fw-bold" href="https://theservicesexchange.com">The Service Exchange</a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="https://theservicesexchange.com/api_docs.html">API Docs</a>
                <button class="btn btn-light ms-3" onclick="showAuth()">Get Started</button>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section class="hero">
        <div class="container">
            <h1>The Service Exchange</h1>
            <p>Buy and sell any service through intelligent matching</p>
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <button class="btn btn-light btn-lg me-3" onclick="showBuyerForm()">I Need a Service</button>
                    <button class="btn btn-primary-custom btn-lg" onclick="showProviderForm()">I Provide Services</button>
                </div>
            </div>
            
            <div class="mt-5">
                <span class="service-tag">House Cleaning</span>
                <span class="service-tag">Web Development</span>
                <span class="service-tag">Tutoring</span>
                <span class="service-tag">Graphic Design</span>
                <span class="service-tag">Home Repairs</span>
                <span class="service-tag">Photography</span>
            </div>
        </div>
    </section>

    <!-- Features -->
    <section class="py-5" style="background: rgba(255,255,255,0.1);">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <div class="feature-card">
                        <h3>üéØ Smart Matching</h3>
                        <p>AI-powered matching connects you with the perfect service provider or job.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <h3>‚≠ê Reputation Based</h3>
                        <p>Build your reputation and get matched with better opportunities.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <h3>üí∞ Fair Pricing</h3>
                        <p>Market-driven pricing ensures fair rates for everyone.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats -->
    <section class="stats">
        <div class="container text-center">
            <div class="row">
                <div class="col-md-3">
                    <h2>10K+</h2>
                    <p>Active Users</p>
                </div>
                <div class="col-md-3">
                    <h2>50K+</h2>
                    <p>Services Completed</p>
                </div>
                <div class="col-md-3">
                    <h2>$2M+</h2>
                    <p>Total Transacted</p>
                </div>
                <div class="col-md-3">
                    <h2>4.8‚òÖ</h2>
                    <p>Average Rating</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Auth Modal -->
    <div class="modal fade" id="authModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Get Started</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs mb-3">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#login">Login</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#register">Register</a>
                        </li>
                    </ul>
                    
                    <div class="tab-content">
                        <div class="tab-pane active" id="login">
                            <form id="loginForm">
                                <div class="mb-3">
                                    <input type="text" class="form-control" placeholder="Username" id="loginUsername" required>
                                </div>
                                <div class="mb-3">
                                    <input type="password" class="form-control" placeholder="Password" id="loginPassword" required>
                                </div>
                                <button type="submit" class="btn btn-primary w-100">Login</button>
                            </form>
                        </div>
                        
                        <div class="tab-pane" id="register">
                            <form id="registerForm">
                                <div class="mb-3">
                                    <input type="text" class="form-control" placeholder="Username" id="regUsername" required>
                                </div>
                                <div class="mb-3">
                                    <input type="password" class="form-control" placeholder="Password (min 8 chars)" id="regPassword" required>
                                </div>
                                <button type="submit" class="btn btn-primary w-100">Register</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Service Request Modal -->
    <div class="modal fade" id="bidModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Request a Service</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="bidForm">
                        <div class="mb-3">
                            <textarea class="form-control" rows="3" placeholder="Describe the service you need" id="bidService" required></textarea>
                        </div>
                        <div class="mb-3">
                            <input type="number" class="form-control" placeholder="Price (USD)" id="bidPrice" required>
                        </div>
                        <div class="mb-3">
                            <select class="form-control" id="bidLocationType">
                                <option value="physical">Physical (In-Person)</option>
                                <option value="remote">Remote (Online)</option>
                                <option value="hybrid">Hybrid</option>
                            </select>
                        </div>
                        <div class="mb-3" id="addressField">
                            <input type="text" class="form-control" placeholder="Service Address" id="bidAddress">
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Submit Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Provider Modal -->
    <div class="modal fade" id="providerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Find a Job</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="providerForm">
                        <div class="mb-3">
                            <textarea class="form-control" rows="3" placeholder="Your capabilities and services" id="capabilities" required></textarea>
                        </div>
                        <div class="mb-3">
                            <select class="form-control" id="providerLocationType">
                                <option value="physical">Physical (In-Person)</option>
                                <option value="remote">Remote (Online)</option>
                                <option value="hybrid">Both</option>
                            </select>
                        </div>
                        <div class="mb-3" id="providerAddressField">
                            <input type="text" class="form-control" placeholder="Your Location" id="providerAddress">
                        </div>
                        <div class="mb-3" id="distanceField">
                            <input type="number" class="form-control" placeholder="Max Distance (miles)" id="maxDistance" value="10">
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Find Job</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_URL = 'https://rse-api.com:5003';
        let authToken = localStorage.getItem('auth_token');
        
        function showAuth() {
            new bootstrap.Modal(document.getElementById('authModal')).show();
        }
        
        function showBuyerForm() {
            if (!authToken) {
                showAuth();
                return;
            }
            new bootstrap.Modal(document.getElementById('bidModal')).show();
        }
        
        function showProviderForm() {
            if (!authToken) {
                showAuth();
                return;
            }
            new bootstrap.Modal(document.getElementById('providerModal')).show();
        }
        
        // Location type handling
        document.getElementById('bidLocationType').addEventListener('change', (e) => {
            document.getElementById('addressField').style.display = 
                e.target.value === 'remote' ? 'none' : 'block';
        });
        
        document.getElementById('providerLocationType').addEventListener('change', (e) => {
            const showAddress = e.target.value !== 'remote';
            document.getElementById('providerAddressField').style.display = showAddress ? 'block' : 'none';
            document.getElementById('distanceField').style.display = showAddress ? 'block' : 'none';
        });
        
        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const response = await fetch(`${API_URL}/login`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    username: document.getElementById('loginUsername').value,
                    password: document.getElementById('loginPassword').value
                })
            });
            
            if (response.ok) {
                const data = await response.json();
                authToken = data.access_token;
                localStorage.setItem('auth_token', authToken);
                bootstrap.Modal.getInstance(document.getElementById('authModal')).hide();
                alert('Login successful!');
            } else {
                alert('Login failed');
            }
        });
        
        // Register
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const response = await fetch(`${API_URL}/register`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    username: document.getElementById('regUsername').value,
                    password: document.getElementById('regPassword').value
                })
            });
            
            if (response.ok) {
                alert('Registration successful! Please login.');
                document.querySelector('[href="#login"]').click();
            } else {
                alert('Registration failed');
            }
        });
        
        // Submit bid
        document.getElementById('bidForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const data = {
                service: document.getElementById('bidService').value,
                price: parseFloat(document.getElementById('bidPrice').value),
                end_time: Math.floor(Date.now() / 1000) + 86400, // 24 hours
                location_type: document.getElementById('bidLocationType').value
            };
            
            if (data.location_type !== 'remote') {
                data.address = document.getElementById('bidAddress').value;
            }
            
            const response = await fetch(`${API_URL}/submit_bid`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${authToken}`
                },
                body: JSON.stringify(data)
            });
            
            if (response.ok) {
                const result = await response.json();
                alert(`Service request submitted! ID: ${result.bid_id}`);
                bootstrap.Modal.getInstance(document.getElementById('bidModal')).hide();
            } else {
                alert('Failed to submit request');
            }
        });
        
        // Find job
        document.getElementById('providerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const data = {
                capabilities: document.getElementById('capabilities').value,
                location_type: document.getElementById('providerLocationType').value
            };
            
            if (data.location_type !== 'remote') {
                data.address = document.getElementById('providerAddress').value;
                data.max_distance = parseFloat(document.getElementById('maxDistance').value);
            }
            
            const response = await fetch(`${API_URL}/grab_job`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${authToken}`
                },
                body: JSON.stringify(data)
            });
            
            if (response.ok) {
                const job = await response.json();
                alert(`Job found!\nService: ${job.service}\nPrice: $${job.price}\nBuyer: ${job.buyer_username}`);
                bootstrap.Modal.getInstance(document.getElementById('providerModal')).hide();
            } else if (response.status === 204) {
                alert('No matching jobs available');
            } else {
                alert('Failed to find job');
            }
        });
    </script>
</body>
</html>